<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Agglomerate data using taxonomic information — agglomerate-methods • mia</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Agglomerate data using taxonomic information — agglomerate-methods" />
<meta property="og:description" content="agglomerateByRank can be used to sum up data based on the association
to certain taxonomic ranks given as rowData. Only available
taxonomicRanks can be used." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mia.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/microbiome/mia/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Agglomerate data using taxonomic information</h1>
    <small class="dont-index">Source: <a href='https://github.com/microbiome/mia/blob/master/R/agglomerate.R'><code>R/agglomerate.R</code></a></small>
    <div class="hidden name"><code>agglomerate-methods.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>agglomerateByRank</code> can be used to sum up data based on the association
to certain taxonomic ranks given as <code>rowData</code>. Only available
<code><a href='taxonomy-methods.html'>taxonomicRanks</a></code> can be used.</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for SummarizedExperiment</span>
<span class='fu'>agglomerateByRank</span><span class='op'>(</span>
  <span class='va'>x</span>,
  rank <span class='op'>=</span> <span class='fu'><a href='taxonomy-methods.html'>taxonomyRanks</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,
  onRankOnly <span class='op'>=</span> <span class='cn'>FALSE</span>,
  na.rm <span class='op'>=</span> <span class='cn'>FALSE</span>,
  empty.fields <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='st'>""</span>, <span class='st'>" "</span>, <span class='st'>"\t"</span>, <span class='st'>"-"</span>, <span class='st'>"_"</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S4 method for SingleCellExperiment</span>
<span class='fu'>agglomerateByRank</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span>, altexp <span class='op'>=</span> <span class='cn'>NULL</span>, strip_altexp <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># S4 method for TreeSummarizedExperiment</span>
<span class='fu'>agglomerateByRank</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span>, agglomerateTree <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a
<code><a href='https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html'>SummarizedExperiment</a></code>
object</p></td>
    </tr>
    <tr>
      <th>rank</th>
      <td><p>a single character defining a taxonomic rank. Must be a value of
<code><a href='taxonomy-methods.html'>taxonomicRanks()</a></code> function.</p></td>
    </tr>
    <tr>
      <th>onRankOnly</th>
      <td><p><code>TRUE</code> or <code>FALSE</code>: Should information only from
the specified rank used or from ranks equal and above? See details.
(default: <code>onRankOnly = FALSE</code>)</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p><code>TRUE</code> or <code>FALSE</code>: Should taxa with an empty rank be
removed? Use it with caution, since empty entries on the selected rank
will be dropped. This setting can be tweaked by defining
<code>empty.fields</code> to your needs. (default: <code>na.rm = TRUE</code>)</p></td>
    </tr>
    <tr>
      <th>empty.fields</th>
      <td><p>a <code>character</code> value defining, which values should be
regarded as empty. (Default: <code><a href='https://rdrr.io/r/base/c.html'>c(NA, "", " ", "\t")</a></code>). They will be
removed if <code>na.rm = TRUE</code> before agglomeration.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>arguments passed to <code>agglomerateByRank</code> function for
<code>SummarizedExperiment</code> objects,
<code><a href='merge-methods.html'>mergeRows</a></code> and
<code><a href='https://rdrr.io/pkg/scuttle/man/sumCountsAcrossFeatures.html'>sumCountsAcrossFeatures</a></code>.</p></td>
    </tr>
    <tr>
      <th>altexp</th>
      <td><p>String or integer scalar specifying an alternative experiment
containing the input data.</p></td>
    </tr>
    <tr>
      <th>strip_altexp</th>
      <td><p><code>TRUE</code> or <code>FALSE</code>: Should alternative
experiments be removed prior to agglomeration? This prevents to many
nested alternative experiments by default (default:
<code>strip_altexp = TRUE</code>)</p></td>
    </tr>
    <tr>
      <th>agglomerateTree</th>
      <td><p><code>TRUE</code> or <code>FALSE</code>: should to
<code>rowTree()</code> also be agglomerated? (Default:
<code>agglomerateTree = FALSE</code>)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A taxonomically-agglomerated, optionally-pruned object of the same
class <code>x</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Based on the available taxonomic data and its structure setting
<code>onRankOnly = TRUE</code> has certain implications on the interpretability of
your results. If no loops exist (loops meaning two higher ranks containing
the same lower rank), the results should be comparable. you can check for
loops using <code><a href='https://rdrr.io/pkg/TreeSummarizedExperiment/man/detectLoop.html'>detectLoop</a></code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='merge-methods.html'>mergeRows</a></code>,
<code><a href='https://rdrr.io/pkg/scuttle/man/sumCountsAcrossFeatures.html'>sumCountsAcrossFeatures</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>GlobalPatterns</span><span class='op'>)</span>
<span class='co'># print the available taxonomic ranks</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='fu'>rowData</span><span class='op'>(</span><span class='va'>GlobalPatterns</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "Kingdom" "Phylum"  "Class"   "Order"   "Family"  "Genus"   "Species"</div><div class='input'><span class='fu'><a href='taxonomy-methods.html'>taxonomyRanks</a></span><span class='op'>(</span><span class='va'>GlobalPatterns</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "Kingdom" "Phylum"  "Class"   "Order"   "Family"  "Genus"   "Species"</div><div class='input'>
<span class='co'># agglomerate at the Family taxonomic rank</span>
<span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='fu'>agglomerateByRank</span><span class='op'>(</span><span class='va'>GlobalPatterns</span>, rank<span class='op'>=</span><span class='st'>"Family"</span><span class='op'>)</span>
<span class='co'>## How many taxa before/after agglomeration?</span>
<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>GlobalPatterns</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 19216</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>x1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 603</div><div class='input'>
<span class='co'># with agglomeration of the tree</span>
<span class='va'>x2</span> <span class='op'>&lt;-</span> <span class='fu'>agglomerateByRank</span><span class='op'>(</span><span class='va'>GlobalPatterns</span>, rank<span class='op'>=</span><span class='st'>"Family"</span>,
                        agglomerateTree <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: The root is added with label 'ALL'</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>x2</span><span class='op'>)</span> <span class='co'># same number of rows, but</span>
</div><div class='output co'>#&gt; [1] 603</div><div class='input'><span class='fu'>rowTree</span><span class='op'>(</span><span class='va'>x1</span><span class='op'>)</span> <span class='co'># ... different</span>
</div><div class='output co'>#&gt; 
#&gt; Phylogenetic tree with 19216 tips and 19215 internal nodes.
#&gt; 
#&gt; Tip labels:
#&gt;   549322, 522457, 951, 244423, 586076, 246140, ...
#&gt; Node labels:
#&gt;   , 0.858.4, 1.000.154, 0.764.3, 0.995.2, 1.000.2, ...
#&gt; 
#&gt; Rooted; includes branch lengths.</div><div class='input'><span class='fu'>rowTree</span><span class='op'>(</span><span class='va'>x2</span><span class='op'>)</span> <span class='co'># ... tree</span>
</div><div class='output co'>#&gt; 
#&gt; Phylogenetic tree with 496 tips and 260 internal nodes.
#&gt; 
#&gt; Tip labels:
#&gt;   Family:Cenarchaeaceae, Family:SAGMA-X, Family:Nitrososphaeraceae, Family:Sulfolobaceae, Family:Halobacteriaceae, Family:Methanobacteriaceae, ...
#&gt; Node labels:
#&gt;   root:ALL, Kingdom:Archaea, Phylum:Crenarchaeota, Class:C2, Class:Sd-NA, Class:Thaumarchaeota, ...
#&gt; 
#&gt; Rooted; includes branch lengths.</div><div class='input'>
<span class='co'># removing empty labels by setting na.rm = TRUE</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='fu'>rowData</span><span class='op'>(</span><span class='va'>GlobalPatterns</span><span class='op'>)</span><span class='op'>$</span><span class='va'>Family</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 5603</div><div class='input'>
<span class='co'>## Look at enterotype dataset...</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>enterotype</span><span class='op'>)</span>
<span class='co'>## print the available taxonomic ranks. Shows only 1 rank available</span>
<span class='co'>## not useful for agglomerateByRank</span>
<span class='fu'><a href='taxonomy-methods.html'>taxonomyRanks</a></span><span class='op'>(</span><span class='va'>enterotype</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "Genus"</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Felix G.M. Ernst, Sudarshan Shetty, Tuomas Borman, Leo Lahti.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


