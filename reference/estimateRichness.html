<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Estimate richness measures — estimateRichness • mia</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Estimate richness measures — estimateRichness" />
<meta property="og:description" content="Several functions for calculation of community richness indices available via
wrapper functions. They are implemented via the vegan package." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mia.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/microbiome/mia/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate richness measures</h1>
    <small class="dont-index">Source: <a href='https://github.com/microbiome/mia/blob/master/R/estimateRichness.R'><code>R/estimateRichness.R</code></a></small>
    <div class="hidden name"><code>estimateRichness.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Several functions for calculation of community richness indices available via
wrapper functions. They are implemented via the <code>vegan</code> package.</p>
    </div>

    <pre class="usage"><span class='fu'>estimateRichness</span><span class='op'>(</span>
  <span class='va'>x</span>,
  abund_values <span class='op'>=</span> <span class='st'>"counts"</span>,
  index <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"observed"</span>, <span class='st'>"chao1"</span>, <span class='st'>"ace"</span>, <span class='st'>"hill"</span><span class='op'>)</span>,
  name <span class='op'>=</span> <span class='va'>index</span>,
  detection <span class='op'>=</span> <span class='fl'>0</span>,
  <span class='va'>...</span>,
  BPPARAM <span class='op'>=</span> <span class='fu'>SerialParam</span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># S4 method for SummarizedExperiment</span>
<span class='fu'>estimateRichness</span><span class='op'>(</span>
  <span class='va'>x</span>,
  abund_values <span class='op'>=</span> <span class='st'>"counts"</span>,
  index <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"observed"</span>, <span class='st'>"chao1"</span>, <span class='st'>"ace"</span>, <span class='st'>"hill"</span><span class='op'>)</span>,
  name <span class='op'>=</span> <span class='va'>index</span>,
  detection <span class='op'>=</span> <span class='fl'>0</span>,
  <span class='va'>...</span>,
  BPPARAM <span class='op'>=</span> <span class='fu'>SerialParam</span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a <code>SummarizedExperiment</code> object</p></td>
    </tr>
    <tr>
      <th>abund_values</th>
      <td><p>the name of the assay used for calculation of the
sample-wise estimates</p></td>
    </tr>
    <tr>
      <th>index</th>
      <td><p>a <code>character</code> vector, specifying the richness measures
to be calculated.</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>a name for the column(s) of the colData the results should be
stored in.</p></td>
    </tr>
    <tr>
      <th>detection</th>
      <td><p>a numeric value for selecting detection threshold
for the abundances. The default detection threshold is 0.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional parameters passed to <code>estimateRichness</code></p></td>
    </tr>
    <tr>
      <th>BPPARAM</th>
      <td><p>A
<code><a href='https://rdrr.io/pkg/BiocParallel/man/BiocParallelParam-class.html'>BiocParallelParam</a></code>
object specifying whether calculation of estimates should be parallelized.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>x</code> with additional <code>colData</code> named
<code>*name*</code></p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>These include the &#8216;Observed&#8217;, &#8216;Chao1&#8217; and
&#8216;ACE&#8217; and &#8216;Hill&#8217; richness measures.
See details for more information and references.</p>
<p>The richness is calculated per sample. This is a standard index in community
ecology, and it provides an estimate of the number of unique species in the
community. This is often not directly observed for the whole community but only
for a limited sample from the community. This has led to alternative richness</p>
<p>Richness index differs from the concept of species diversity or evenness in
that it ignores species abundance, and focuses on the binary presence/absence
values that indicate simply whether the species was detected.</p>
<p>The function takes all index names in full lowercase. The user can provide the
desired spelling through the argument <code><a href='https://rdrr.io/r/base/name.html'>name</a></code> (see examples).</p>
<p>The following richness indices are provided.</p>
<ul>
<li><p>'observed' The <em>observed richness</em> gives the number of species that
is detected above a given <code>detection</code> threshold in the observed sample
(default 0). This is conceptually the simplest richness index. The corresponding
index in the <span class="pkg">vegan</span> package is "richness".</p></li>
<li><p>'chao1' This is a nonparametric estimator of species richness. It
assumes that rare species carry information about the (unknown) number
of unobserved species. We use here the bias-corrected version
(O'Hara 2005, Chiu et al. 2014) implemented in
<code><a href='https://rdrr.io/pkg/vegan/man/specpool.html'>estimateR</a></code>. This index implicitly
assumes that every taxa has equal probability of being observed. Note
that it gives a lower bound to species richness. The bias-corrected
For an exact formulation, see <code><a href='https://rdrr.io/pkg/vegan/man/specpool.html'>estimateR</a></code>.
This estimator uses only the singleton and doubleton counts, and
hence it gives more weight to the low abundance species.
Note that this index comes with an additional column with standard
error information.</p></li>
<li><p>'ace' Abundance-based coverage estimator (ACE) is another nonparametric richness
index that uses sample coverage, defined based on the sum of the probabilities
of the observed species. This method divides the species into abundant (more than 10
reads or observations) and rare groups
in a sample and tends to underestimate the real number of species. The ACE index
ignores the abundance information for the abundant species,
based on the assumption that the abundant species are observed regardless of their
exact abundance. We use here the bias-corrected version
(O'Hara 2005, Chiu et al. 2014) implemented in
<code><a href='https://rdrr.io/pkg/vegan/man/specpool.html'>estimateR</a></code>.
For an exact formulation, see <code><a href='https://rdrr.io/pkg/vegan/man/specpool.html'>estimateR</a></code>.
Note that this index comes with an additional column with standard
error information.</p></li>
<li><p>'hill' Effective species richness aka Hill index (see e.g. Chao et al. 2016).
Currently only the case 1D is implemented. This corresponds to the exponent
of Shannon diversity. Intuitively, the effective richness indicates the number of
species whose even distribution would lead to tha same diversity than the observed
community, where the species abundances are unevenly distributed.</p></li>
</ul>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Chao A. (1984)
Non-parametric estimation of the number of classes in a population.
<em>Scand J Stat.</em> 11:265–270.</p>
<p>Chao A, Chun-Huo C, Jost L (2016).
Phylogenetic Diversity Measures and Their Decomposition:
A Framework Based on Hill Numbers. Biodiversity Conservation and Phylogenetic Systematics,
Springer International Publishing, pp. 141–172, doi:10.1007/978-3-319-22461-9_8.</p>
<p>Chiu, C.H., Wang, Y.T., Walther, B.A. &amp; Chao, A. (2014).
Improved nonparametric lower bound of species richness via a modified
Good-Turing frequency formula.
<em>Biometrics</em> 70, 671-682.</p>
<p>O'Hara, R.B. (2005).
Species richness estimators: how many species can dance on the head of a pin?
<em>J. Anim. Ecol.</em> 74, 375-386.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/scater/man/plotColData.html'>plotColData</a></code></p><ul>
<li><p><code><a href='https://rdrr.io/pkg/vegan/man/specpool.html'>estimateR</a></code></p></li>
</ul>
</div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Leo Lahti. Contact: <a href='microbiome.github.io'>microbiome.github.io</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>esophagus</span><span class='op'>)</span>

<span class='co'># Calculates all richness indices by default</span>
<span class='va'>esophagus</span> <span class='op'>&lt;-</span> <span class='fu'>estimateRichness</span><span class='op'>(</span><span class='va'>esophagus</span><span class='op'>)</span>

<span class='co'># Shows all indices</span>
<span class='fu'>colData</span><span class='op'>(</span><span class='va'>esophagus</span><span class='op'>)</span>
</div><div class='output co'>#&gt; DataFrame with 3 rows and 6 columns
#&gt;    observed     chao1  chao1_se       ace    ace_se      hill
#&gt;   &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
#&gt; B        28   39.1429   8.22425   49.0970   4.12372   9.48173
#&gt; C        33   37.5000   4.10381   40.9465   3.10030  15.83763
#&gt; D        38   71.0000  19.32178   88.9768   6.50671   7.63309</div><div class='input'>
<span class='co'># Shows Hill index</span>
<span class='fu'>colData</span><span class='op'>(</span><span class='va'>esophagus</span><span class='op'>)</span><span class='op'>$</span><span class='va'>hill</span>
</div><div class='output co'>#&gt;         B         C         D 
#&gt;  9.481732 15.837635  7.633094 </div><div class='input'>
<span class='co'># Deletes hill index</span>
<span class='fu'>colData</span><span class='op'>(</span><span class='va'>esophagus</span><span class='op'>)</span><span class='op'>$</span><span class='va'>hill</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>

<span class='co'># Shows all indices, hill is deleted</span>
<span class='fu'>colData</span><span class='op'>(</span><span class='va'>esophagus</span><span class='op'>)</span>
</div><div class='output co'>#&gt; DataFrame with 3 rows and 5 columns
#&gt;    observed     chao1  chao1_se       ace    ace_se
#&gt;   &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
#&gt; B        28   39.1429   8.22425   49.0970   4.12372
#&gt; C        33   37.5000   4.10381   40.9465   3.10030
#&gt; D        38   71.0000  19.32178   88.9768   6.50671</div><div class='input'>
<span class='co'># Delete the remaining indices</span>
<span class='fu'>colData</span><span class='op'>(</span><span class='va'>esophagus</span><span class='op'>)</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"observed"</span>, <span class='st'>"chao1"</span>, <span class='st'>"ace"</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>

<span class='co'># Calculates observed richness index and saves them with specific names</span>
<span class='va'>esophagus</span> <span class='op'>&lt;-</span> <span class='fu'>estimateRichness</span><span class='op'>(</span><span class='va'>esophagus</span>,
    index <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"observed"</span>, <span class='st'>"chao1"</span>, <span class='st'>"ace"</span>, <span class='st'>"hill"</span><span class='op'>)</span>,
     name <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Observed"</span>, <span class='st'>"Chao1"</span>, <span class='st'>"ACE"</span>, <span class='st'>"Hill"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Show the new indices</span>
<span class='fu'>colData</span><span class='op'>(</span><span class='va'>esophagus</span><span class='op'>)</span>
</div><div class='output co'>#&gt; DataFrame with 3 rows and 8 columns
#&gt;    chao1_se    ace_se  Observed     Chao1  Chao1_se       ACE    ACE_se
#&gt;   &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
#&gt; B   8.22425   4.12372        28   39.1429   8.22425   49.0970   4.12372
#&gt; C   4.10381   3.10030        33   37.5000   4.10381   40.9465   3.10030
#&gt; D  19.32178   6.50671        38   71.0000  19.32178   88.9768   6.50671
#&gt;        Hill
#&gt;   &lt;numeric&gt;
#&gt; B   9.48173
#&gt; C  15.83763
#&gt; D   7.63309</div><div class='input'>
<span class='co'># Deletes all colData (including the indices)</span>
<span class='fu'>colData</span><span class='op'>(</span><span class='va'>esophagus</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>

<span class='co'># Calculate observed richness excluding singletons (detection limit 1)</span>
<span class='va'>esophagus</span> <span class='op'>&lt;-</span> <span class='fu'>estimateRichness</span><span class='op'>(</span><span class='va'>esophagus</span>, index<span class='op'>=</span><span class='st'>"observed"</span>, detection <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='co'># Deletes all colData (including the indices)</span>
<span class='fu'>colData</span><span class='op'>(</span><span class='va'>esophagus</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>

<span class='co'># Indices must be written correctly (all lowercase), otherwise an error</span>
<span class='co'># gets thrown</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='va'>esophagus</span> <span class='op'>&lt;-</span> <span class='fu'>estimateRichness</span><span class='op'>(</span><span class='va'>esophagus</span>, index<span class='op'>=</span><span class='st'>"ACE"</span><span class='op'>)</span>

<span class='co'># Calculates Chao1 and ACE indices only</span>
<span class='va'>esophagus</span> <span class='op'>&lt;-</span> <span class='fu'>estimateRichness</span><span class='op'>(</span><span class='va'>esophagus</span>, index<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"chao1"</span>, <span class='st'>"ace"</span><span class='op'>)</span>, name<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Chao1"</span>, <span class='st'>"ACE"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Deletes all colData (including the indices)</span>
<span class='fu'>colData</span><span class='op'>(</span><span class='va'>esophagus</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>

<span class='co'># Names of columns can be chosen arbitrarily, but the length of arguments must match.</span>
<span class='va'>esophagus</span> <span class='op'>&lt;-</span> <span class='fu'>estimateRichness</span><span class='op'>(</span><span class='va'>esophagus</span>,
                               index <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ace"</span>, <span class='st'>"chao1"</span><span class='op'>)</span>,
                               name <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"index1"</span>, <span class='st'>"index2"</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># Shows all indices</span>
<span class='fu'>colData</span><span class='op'>(</span><span class='va'>esophagus</span><span class='op'>)</span>
</div><div class='output co'>#&gt; DataFrame with 3 rows and 4 columns
#&gt;      index1 index1_se    index2 index2_se
#&gt;   &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
#&gt; B   49.0970   4.12372   39.1429   8.22425
#&gt; C   40.9465   3.10030   37.5000   4.10381
#&gt; D   88.9768   6.50671   71.0000  19.32178</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Felix G.M. Ernst, Sudarshan Shetty, Tuomas Borman, Leo Lahti.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


