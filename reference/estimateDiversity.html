<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Estimate diversity measures — estimateDiversity • mia</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Estimate diversity measures — estimateDiversity" />
<meta property="og:description" content="Several functions for calculation of diversity indices available via
wrapper functions. Some of them are implemented via the vegan package." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mia.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/microbiome/mia/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate diversity measures</h1>
    <small class="dont-index">Source: <a href='https://github.com/microbiome/mia/blob/master/R/estimateDiversity.R'><code>R/estimateDiversity.R</code></a></small>
    <div class="hidden name"><code>estimateDiversity.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Several functions for calculation of diversity indices available via
wrapper functions. Some of them are implemented via the <code>vegan</code> package.</p>
    </div>

    <pre class="usage"><span class='fu'>estimateDiversity</span><span class='op'>(</span>
  <span class='va'>x</span>,
  abund_values <span class='op'>=</span> <span class='st'>"counts"</span>,
  index <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"coverage"</span>, <span class='st'>"fisher"</span>, <span class='st'>"gini_simpson"</span>, <span class='st'>"inverse_simpson"</span>,
    <span class='st'>"log_modulo_skewness"</span>, <span class='st'>"shannon"</span><span class='op'>)</span>,
  name <span class='op'>=</span> <span class='va'>index</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S4 method for SummarizedExperiment</span>
<span class='fu'>estimateDiversity</span><span class='op'>(</span>
  <span class='va'>x</span>,
  abund_values <span class='op'>=</span> <span class='st'>"counts"</span>,
  index <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"coverage"</span>, <span class='st'>"fisher"</span>, <span class='st'>"gini_simpson"</span>, <span class='st'>"inverse_simpson"</span>,
    <span class='st'>"log_modulo_skewness"</span>, <span class='st'>"shannon"</span><span class='op'>)</span>,
  name <span class='op'>=</span> <span class='va'>index</span>,
  <span class='va'>...</span>,
  BPPARAM <span class='op'>=</span> <span class='fu'>SerialParam</span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># S4 method for TreeSummarizedExperiment</span>
<span class='fu'>estimateDiversity</span><span class='op'>(</span>
  <span class='va'>x</span>,
  abund_values <span class='op'>=</span> <span class='st'>"counts"</span>,
  index <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"coverage"</span>, <span class='st'>"faith"</span>, <span class='st'>"fisher"</span>, <span class='st'>"gini_simpson"</span>, <span class='st'>"inverse_simpson"</span>,
    <span class='st'>"log_modulo_skewness"</span>, <span class='st'>"shannon"</span><span class='op'>)</span>,
  name <span class='op'>=</span> <span class='va'>index</span>,
  <span class='va'>...</span>,
  BPPARAM <span class='op'>=</span> <span class='fu'>SerialParam</span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='fu'>estimateFaith</span><span class='op'>(</span>
  <span class='va'>x</span>,
  tree <span class='op'>=</span> <span class='st'>"missing"</span>,
  abund_values <span class='op'>=</span> <span class='st'>"counts"</span>,
  name <span class='op'>=</span> <span class='st'>"faith"</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S4 method for SummarizedExperiment,phylo</span>
<span class='fu'>estimateFaith</span><span class='op'>(</span>
  <span class='va'>x</span>,
  tree <span class='op'>=</span> <span class='st'>"missing"</span>,
  abund_values <span class='op'>=</span> <span class='st'>"counts"</span>,
  name <span class='op'>=</span> <span class='st'>"faith"</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S4 method for TreeSummarizedExperiment,missing</span>
<span class='fu'>estimateFaith</span><span class='op'>(</span>
  <span class='va'>x</span>,
  tree <span class='op'>=</span> <span class='st'>"missing"</span>,
  abund_values <span class='op'>=</span> <span class='st'>"counts"</span>,
  name <span class='op'>=</span> <span class='st'>"faith"</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a <code>SummarizedExperiment</code> object</p></td>
    </tr>
    <tr>
      <th>abund_values</th>
      <td><p>the name of the assay used for calculation of the
sample-wise estimates</p></td>
    </tr>
    <tr>
      <th>index</th>
      <td><p>a <code>character</code> vector, specifying the diversity measures
to be calculated.</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>a name for the column(s) of the colData the results should be
stored in.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>optional arguments:</p><ul>
<li><p>threshold A numeric value in the unit interval,
determining the threshold for coverage index. By default, <code>threshold</code> is 0.9.</p></li>
<li><p>quantile Arithmetic abundance classes are evenly cut up to to this quantile
of the data. The assumption is that abundances higher than this are not common, and
they are classified in their own group. By default, <code>quantile</code> is 0.5.</p></li>
<li><p>num_of_classes The number of arithmetic abundance classes from zero to
the quantile cutoff indicated by <code>quantile</code>.
By default, <code>num_of_classes</code> is 50.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>BPPARAM</th>
      <td><p>A
<code><a href='https://rdrr.io/pkg/BiocParallel/man/BiocParallelParam-class.html'>BiocParallelParam</a></code>
object specifying whether calculation of estimates should be parallelized.</p></td>
    </tr>
    <tr>
      <th>tree</th>
      <td><p>A phylogenetic tree that is used to calculate 'faith' index.
If <code>x</code> is a <code>TreeSummarizedExperiment</code>, <code>rowTree(x)</code> is
used by default.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>x</code> with additional <code>colData</code> named <code>*name*</code></p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The available indices include the &#8216;Coverage&#8217;,
&#8216;Faith's phylogenetic diversity&#8217;, &#8216;Fisher alpha&#8217;, &#8216;Gini-Simpson&#8217;,
&#8216;Inverse Simpson&#8217;, &#8216;log-modulo skewness&#8217;, and &#8216;Shannon&#8217;
diversity indices. See details for more information and references.</p>
<p>Diversity is a joint quantity that combines elements or community richness and evenness.
Diversity increases, in general, when species richness or evenness increase.</p>
<p>By default, this function returns all indices.</p>
<ul>
<li><p>'coverage' Number of species needed to cover a given fraction of the ecosystem (50\<!-- % by default). -->
Tune this with the threshold argument.</p></li>
<li><p>'faith' Faith's phylogenetic alpha diversity index measures how long the
taxonomic distance is between taxa that are present in the sample. Larger value
represent higher diversity. (Faith 1992)</p></li>
<li><p>'fisher' Fisher's alpha; as implemented in
<code><a href='https://rdrr.io/pkg/vegan/man/diversity.html'>vegan::fisher.alpha</a></code>. (Fisher et al. 1943)</p></li>
<li><p>'gini_simpson' Gini-Simpson diversity i.e. \(1 - lambda\), where \(lambda\) is the
Simpson index, calculated as the sum of squared relative abundances.
This corresponds to the diversity index
'simpson' in <code><a href='https://rdrr.io/pkg/vegan/man/diversity.html'>vegan::diversity</a></code>.
This is also called Gibbs–Martin, or Blau index in sociology,
psychology and management studies. The Gini-Simpson index (1-lambda) should not be
confused with Simpson's dominance (lambda), Gini index, or inverse Simpson index (1/lambda).</p></li>
<li><p>'inverse_simpson' Inverse Simpson diversity:
\(1/lambda\) where \(lambda=sum(p^2)\) and p refers to relative abundances.
This corresponds to the diversity index
'invsimpson' in vegan::diversity. Don't confuse this with the
closely related Gini-Simpson index</p></li>
<li><p>'log_modulo_skewness' The rarity index characterizes the concentration
of species at low abundance. Here, we use the skewness of the frequency
distribution of arithmetic abundance classes (see Magurran &amp; McGill 2011).
These are typically right-skewed; to avoid taking log of occasional
negative skews, we follow Locey &amp; Lennon (2016) and use the log-modulo
transformation that adds a value of one to each measure of skewness to
allow logarithmization.</p></li>
<li><p>'shannon' Shannon diversity (entropy).</p></li>
</ul>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Beisel J-N. et al. (2003)
A Comparative Analysis of Diversity Index Sensitivity.
<em>Internal Rev. Hydrobiol.</em> 88(1):3-15.
<a href='https://portais.ufg.br/up/202/o/2003-comparative_evennes_index.pdf'>https://portais.ufg.br/up/202/o/2003-comparative_evennes_index.pdf</a></p>
<p>Bulla L. (1994)
An  index of diversity and its associated diversity measure.
<em>Oikos</em> 70:167--171</p>
<p>Faith D.P. (1992)
Conservation evaluation and phylogenetic diversity.
<em>Biological Conservation</em> 61(1):1-10.</p>
<p>Fisher R.A., Corbet, A.S. &amp; Williams, C.B. (1943)
The relation between the number of species and the number of individuals in a
random sample of animal population.
<em>Journal of Animal Ecology</em> <em>12</em>, 42-58.</p>
<p>Locey K.J. &amp; Lennon J.T. (2016)
Scaling laws predict global microbial diversity.
<em>PNAS</em> 113(21):5970-5975.</p>
<p>Magurran A.E., McGill BJ, eds (2011)
Biological Diversity: Frontiers in Measurement and Assessment.
(Oxford Univ Press, Oxford), Vol 12.</p>
<p>Smith B. &amp; Wilson JB. (1996)
A Consumer's Guide to Diversity Indices.
<em>Oikos</em> 76(1):70-82.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/scater/man/plotColData.html'>plotColData</a></code></p><ul>
<li><p><code><a href='estimateRichness.html'>estimateRichness</a></code></p></li>
<li><p><code><a href='estimateEvenness.html'>estimateEvenness</a></code></p></li>
<li><p><code><a href='estimateDominance.html'>estimateDominance</a></code></p></li>
<li><p><code><a href='https://rdrr.io/pkg/vegan/man/diversity.html'>diversity</a></code></p></li>
<li><p><code><a href='https://rdrr.io/pkg/vegan/man/specpool.html'>estimateR</a></code></p></li>
</ul>
</div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>GlobalPatterns</span><span class='op'>)</span>
<span class='va'>tse</span> <span class='op'>&lt;-</span> <span class='va'>GlobalPatterns</span>

<span class='co'># All index names as known by the function</span>
<span class='va'>index</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"shannon"</span>,<span class='st'>"gini_simpson"</span>,<span class='st'>"inverse_simpson"</span>, <span class='st'>"coverage"</span>, <span class='st'>"fisher"</span>, 
<span class='st'>"faith"</span>,  <span class='st'>"log_modulo_skewness"</span><span class='op'>)</span>

<span class='co'># Corresponding polished names</span>
<span class='va'>name</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Shannon"</span>,<span class='st'>"GiniSimpson"</span>,<span class='st'>"InverseSimpson"</span>, <span class='st'>"Coverage"</span>, <span class='st'>"Fisher"</span>, 
<span class='st'>"Faith"</span>,  <span class='st'>"LogModSkewness"</span><span class='op'>)</span>

<span class='co'># Calculate diversities</span>
<span class='va'>tse</span> <span class='op'>&lt;-</span> <span class='fu'>estimateDiversity</span><span class='op'>(</span><span class='va'>tse</span>, index <span class='op'>=</span> <span class='va'>index</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='input'>
<span class='co'># The colData contains the indices with their code names by default</span>
<span class='fu'>colData</span><span class='op'>(</span><span class='va'>tse</span><span class='op'>)</span><span class='op'>[</span>, <span class='va'>index</span><span class='op'>]</span>
</div><div class='output co'>#&gt; DataFrame with 26 rows and 7 columns
#&gt;           shannon gini_simpson inverse_simpson  coverage    fisher     faith
#&gt;         &lt;numeric&gt;    &lt;numeric&gt;       &lt;numeric&gt; &lt;integer&gt; &lt;numeric&gt; &lt;numeric&gt;
#&gt; CL3       6.57652     0.994656        187.1298      1113  1035.008   250.535
#&gt; CC1       6.77660     0.995212        208.8436      1374  1107.495   262.263
#&gt; SV1       6.49849     0.996290        269.5441       829   854.279   208.458
#&gt; M31Fcsw   3.82837     0.927599         13.8119        71   313.719   117.876
#&gt; M11Fcsw   3.28767     0.909738         11.0789        37   289.979   119.825
#&gt; ...           ...          ...             ...       ...       ...       ...
#&gt; TS28      4.12654     0.965175         28.7152        62   337.892   124.651
#&gt; TS29      3.45277     0.918098         12.2097        46   318.969   121.206
#&gt; Even1     4.08366     0.968198         31.4447        51   546.578   179.938
#&gt; Even2     3.95691     0.963916         27.7129        47   401.760   140.810
#&gt; Even3     4.00637     0.967340         30.6189        49   344.939   126.569
#&gt;         log_modulo_skewness
#&gt;                   &lt;numeric&gt;
#&gt; CL3                 2.06142
#&gt; CC1                 2.06142
#&gt; SV1                 2.06142
#&gt; M31Fcsw             2.06141
#&gt; M11Fcsw             2.06141
#&gt; ...                     ...
#&gt; TS28                2.06141
#&gt; TS29                2.06142
#&gt; Even1               2.06141
#&gt; Even2               2.06141
#&gt; Even3               2.06141</div><div class='input'>
<span class='co'># Removing indices</span>
<span class='fu'>colData</span><span class='op'>(</span><span class='va'>tse</span><span class='op'>)</span><span class='op'>[</span>, <span class='va'>index</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>

<span class='co'># 'threshold' can be used to determine threshold for 'coverage' index</span>
<span class='va'>tse</span> <span class='op'>&lt;-</span> <span class='fu'>estimateDiversity</span><span class='op'>(</span><span class='va'>tse</span>, index <span class='op'>=</span> <span class='st'>"coverage"</span>, threshold <span class='op'>=</span> <span class='fl'>0.75</span><span class='op'>)</span>
<span class='co'># 'quantile' and 'num_of_classes' can be used when 'log_modulo_skewness' is calculated</span>
<span class='va'>tse</span> <span class='op'>&lt;-</span> <span class='fu'>estimateDiversity</span><span class='op'>(</span><span class='va'>tse</span>, index <span class='op'>=</span> <span class='st'>"log_modulo_skewness"</span>, quantile <span class='op'>=</span> <span class='fl'>0.75</span>, num_of_classes <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>

<span class='co'># It is recommended to specify also the final names used in the output.</span>
<span class='va'>tse</span> <span class='op'>&lt;-</span> <span class='fu'>estimateDiversity</span><span class='op'>(</span><span class='va'>tse</span>,
  index <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"shannon"</span>, <span class='st'>"gini_simpson"</span>, <span class='st'>"inverse_simpson"</span>, <span class='st'>"coverage"</span>, <span class='st'>"fisher"</span>, 
  <span class='st'>"faith"</span>, <span class='st'>"log_modulo_skewness"</span><span class='op'>)</span>,
   name <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Shannon"</span>, <span class='st'>"GiniSimpson"</span>,  <span class='st'>"InverseSimpson"</span>,  <span class='st'>"Coverage"</span>, <span class='st'>"Fisher"</span>, 
   <span class='st'>"Faith"</span>, <span class='st'>"LogModSkewness"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs produced</span></div><div class='input'>
<span class='co'># The colData contains the indices by their new names provided by the user</span>
<span class='fu'>colData</span><span class='op'>(</span><span class='va'>tse</span><span class='op'>)</span><span class='op'>[</span>, <span class='va'>name</span><span class='op'>]</span>
</div><div class='output co'>#&gt; DataFrame with 26 rows and 7 columns
#&gt;           Shannon GiniSimpson InverseSimpson  Coverage    Fisher     Faith
#&gt;         &lt;numeric&gt;   &lt;numeric&gt;      &lt;numeric&gt; &lt;integer&gt; &lt;numeric&gt; &lt;numeric&gt;
#&gt; CL3       6.57652    0.994656       187.1298      1113  1035.008   250.535
#&gt; CC1       6.77660    0.995212       208.8436      1374  1107.495   262.263
#&gt; SV1       6.49849    0.996290       269.5441       829   854.279   208.458
#&gt; M31Fcsw   3.82837    0.927599        13.8119        71   313.719   117.876
#&gt; M11Fcsw   3.28767    0.909738        11.0789        37   289.979   119.825
#&gt; ...           ...         ...            ...       ...       ...       ...
#&gt; TS28      4.12654    0.965175        28.7152        62   337.892   124.651
#&gt; TS29      3.45277    0.918098        12.2097        46   318.969   121.206
#&gt; Even1     4.08366    0.968198        31.4447        51   546.578   179.938
#&gt; Even2     3.95691    0.963916        27.7129        47   401.760   140.810
#&gt; Even3     4.00637    0.967340        30.6189        49   344.939   126.569
#&gt;         LogModSkewness
#&gt;              &lt;numeric&gt;
#&gt; CL3            2.06142
#&gt; CC1            2.06142
#&gt; SV1            2.06142
#&gt; M31Fcsw        2.06141
#&gt; M11Fcsw        2.06141
#&gt; ...                ...
#&gt; TS28           2.06141
#&gt; TS29           2.06142
#&gt; Even1          2.06141
#&gt; Even2          2.06141
#&gt; Even3          2.06141</div><div class='input'>
<span class='co'># Compare the indices visually</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/pairs.html'>pairs</a></span><span class='op'>(</span><span class='fu'>colData</span><span class='op'>(</span><span class='va'>tse</span><span class='op'>)</span><span class='op'>[</span>, <span class='va'>name</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='img'><img src='estimateDiversity-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Plotting the diversities - use the selected names</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://bioconductor.org/packages/scater/'>scater</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/scater/man/plotColData.html'>plotColData</a></span><span class='op'>(</span><span class='va'>tse</span>, <span class='st'>"Shannon"</span><span class='op'>)</span>
</div><div class='img'><img src='estimateDiversity-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># ... by sample type</span>
<span class='fu'><a href='https://rdrr.io/pkg/scater/man/plotColData.html'>plotColData</a></span><span class='op'>(</span><span class='va'>tse</span>, <span class='st'>"Shannon"</span>, <span class='st'>"SampleType"</span><span class='op'>)</span>
</div><div class='img'><img src='estimateDiversity-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># combining different plots</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span>
<span class='va'>plot_index</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Shannon"</span>,<span class='st'>"GiniSimpson"</span><span class='op'>)</span>
<span class='va'>plots</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>plot_index</span>,
                <span class='va'>plotColData</span>,
                object <span class='op'>=</span> <span class='va'>tse</span>,
                x <span class='op'>=</span> <span class='st'>"SampleType"</span>,
                colour_by <span class='op'>=</span> <span class='st'>"SampleType"</span><span class='op'>)</span>
<span class='va'>plots</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>plots</span>,<span class='st'>"+"</span>, <span class='fu'>theme</span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>angle<span class='op'>=</span><span class='fl'>45</span>,hjust<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>plots</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>plot_index</span>
<span class='va'>plots</span><span class='op'>$</span><span class='va'>Shannon</span> <span class='op'>+</span> <span class='va'>plots</span><span class='op'>$</span><span class='va'>GiniSimpson</span> <span class='op'>+</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>guides <span class='op'>=</span> <span class='st'>"collect"</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Felix G.M. Ernst, Sudarshan Shetty, Tuomas Borman, Leo Lahti.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


