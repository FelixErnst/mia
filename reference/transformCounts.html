<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Transform Counts — transformCounts • mia</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Transform Counts — transformCounts" />
<meta property="og:description" content="These functions provide a variety of options for transforming abundance data.
By using transformCounts, transformed table is in assay. By using
specific ZTransform function, Z-transformation can be applied for features.
relAbundanceCounts is a shortcut for fetching relative abundance table." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mia.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/microbiome/mia/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Transform Counts</h1>
    <small class="dont-index">Source: <a href='https://github.com/microbiome/mia/blob/master/R/transformCounts.R'><code>R/transformCounts.R</code></a></small>
    <div class="hidden name"><code>transformCounts.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These functions provide a variety of options for transforming abundance data.
By using <code>transformCounts</code>, transformed table is in <code>assay</code>. By using
specific <code>ZTransform</code> function, Z-transformation can be applied for features.
<code>relAbundanceCounts</code> is a shortcut for fetching relative abundance table.</p>
    </div>

    <pre class="usage"><span class='fu'>transformCounts</span><span class='op'>(</span>
  <span class='va'>x</span>,
  abund_values <span class='op'>=</span> <span class='st'>"counts"</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"relabundance"</span>, <span class='st'>"log10"</span>, <span class='st'>"pa"</span>, <span class='st'>"hellinger"</span>, <span class='st'>"clr"</span><span class='op'>)</span>,
  name <span class='op'>=</span> <span class='va'>method</span>,
  pseudocount <span class='op'>=</span> <span class='cn'>FALSE</span>,
  threshold <span class='op'>=</span> <span class='fl'>0</span>
<span class='op'>)</span>

<span class='co'># S4 method for SummarizedExperiment</span>
<span class='fu'>transformCounts</span><span class='op'>(</span>
  <span class='va'>x</span>,
  abund_values <span class='op'>=</span> <span class='st'>"counts"</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"relabundance"</span>, <span class='st'>"log10"</span>, <span class='st'>"pa"</span>, <span class='st'>"hellinger"</span>, <span class='st'>"clr"</span><span class='op'>)</span>,
  name <span class='op'>=</span> <span class='va'>method</span>,
  pseudocount <span class='op'>=</span> <span class='cn'>FALSE</span>,
  threshold <span class='op'>=</span> <span class='fl'>0</span>
<span class='op'>)</span>

<span class='fu'>ZTransform</span><span class='op'>(</span>
  <span class='va'>x</span>,
  abund_values <span class='op'>=</span> <span class='st'>"counts"</span>,
  name <span class='op'>=</span> <span class='st'>"ZTransform"</span>,
  pseudocount <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>

<span class='co'># S4 method for SummarizedExperiment</span>
<span class='fu'>ZTransform</span><span class='op'>(</span>
  <span class='va'>x</span>,
  abund_values <span class='op'>=</span> <span class='st'>"counts"</span>,
  name <span class='op'>=</span> <span class='st'>"ZTransform"</span>,
  pseudocount <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>

<span class='fu'>relAbundanceCounts</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for SummarizedExperiment</span>
<span class='fu'>relAbundanceCounts</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A <code><a href='https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html'>SummarizedExperiment</a></code>
object.</p></td>
    </tr>
    <tr>
      <th>abund_values</th>
      <td><p>A single character value for selecting the
<code><a href='https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html'>assay</a></code>
to be transformed.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>A single character value for selecting the transformation method.</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>A single character value specifying the name of transformed abundance table.</p></td>
    </tr>
    <tr>
      <th>pseudocount</th>
      <td><p>FALSE or numeric value deciding whether pseudocount is added. Numerical
value specifies the value of pseudocount.</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p>A numeric value for setting threshold for pa transformation. By default it is 0.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>transformCounts</code>, <code>relAbundanceCounts</code>, and <code>ZTransform</code> return
<code>x</code> with additional, transformed abundance table named <code>*name*</code> in
the <code>assay</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>transformCounts</code> applies transformation to abundance table.
Provided transformation methods include:</p>
<ul>
<li><p>'relabundance' Transforms abundances to relative. Generally, all microbiome
data are compositional. That is, e.g., because all measuring instruments have their capacity limits.
To make results comparable with other results, values must be relative. (See e.g. Gloor et al. 2017.)$$relabundance = \frac{x}{x_{tot}}$$
where \(x\) is a single value and \(x_{tot}\) is the sum of
all values.</p></li>
<li><p>'log10' log10 transformation can be used for reducing the skewness of the data.$$log10 = \log_10 x$$
where \(x\) is a single value of data.</p></li>
<li><p>'pa' Transforms table to presence/absence table. All abundances higher
than \(\epsilon\) are transformed to 1 (present), otherwise 0 (absent). By default, threshold is 0.</p></li>
<li><p>'Z' Z-transformation, Z score transformation, or Z-standardization normalizes
the data by shifting (to mean \(\mu\)) and scaling (to standard deviation \(\sigma\)).
Z-transformation can be done with function <code>ZTransform</code>. It is done per rows.
In other words, single value is standardized with respect of feature's values.$$Z = \frac{x + \mu}{\sigma}$$
where \(x\) is a single value, \(\mu\) is the mean of the feature, and
\(\sigma\) is the standard deviation of the feature.</p></li>
<li><p>'hellinger' Hellinger transformation can be used to reduce the impact of
extreme data points. It can be utilize for clustering or ordination analysis.
(See e.g. Legendre &amp; Gallagher 2001.)$$hellinger = \sqrt{\frac{x}{x_{tot}}}$$
where \(x\) is a single value and \(x_{tot}\) is the sum of
all values</p></li>
<li><p>'clr' Centered log ratio (clr) transformation can be used for reducing the
skewness of data and for centering it. (See e.g. Gloor et al. 2017.)$$clr = log_{10}x_{r} - log_{10}µ_{r}$$
where \(x_{r}\) is a single relative value, \(\mu_{r}\) is
mean relative value".</p></li>
</ul>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Gloor GB, Macklaim JM, Pawlowsky-Glahn V &amp; Egozcue JJ (2017)
Microbiome Datasets Are Compositional: And This Is Not Optional.
Frontiers in Microbiology 8: 2224. doi: 10.3389/fmicb.2017.02224</p>
<p>Legendre P &amp; Gallagher ED (2001)
Ecologically meaningful transformations for ordination of species data.
Oecologia 129: 271-280.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Leo Lahti and Tuomas Borman. Contact: <a href='microbiome.github.io'>microbiome.github.io</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>esophagus</span><span class='op'>)</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>esophagus</span>

<span class='co'># By specifying, it is possible to apply different transformations, e.g. clr transformation.</span>
<span class='co'># Pseudocount can be added by specifying 'pseudocount'.</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'>transformCounts</span><span class='op'>(</span><span class='va'>x</span>, method<span class='op'>=</span><span class='st'>"clr"</span>, pseudocount<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>assay</span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"clr"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                  B          C          D
#&gt; 59_8_22  3.2670356  2.0677373  1.0362399
#&gt; 59_5_13 -0.6647901  0.1706173 -0.7555196
#&gt; 59_8_12  0.4338222  1.7110624 -0.7555196
#&gt; 65_3_22 -0.6647901  0.1706173 -0.0623724
#&gt; 65_5_1  -0.6647901 -0.9279950 -0.0623724
#&gt; 65_1_10 -0.6647901 -0.9279950 -0.0623724</div><div class='input'>
<span class='co'># Name of the stored table can be specified. Also, the target of transformation</span>
<span class='co'># can be specified with "abund_values".</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'>transformCounts</span><span class='op'>(</span><span class='va'>x</span>, method<span class='op'>=</span><span class='st'>"hellinger"</span>, name<span class='op'>=</span><span class='st'>"test"</span>, pseudocount<span class='op'>=</span><span class='fl'>5</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>assay</span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"test"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                 B          C          D
#&gt; 59_8_22 0.3340088 0.20984923 0.14016549
#&gt; 59_5_13 0.1007074 0.11333153 0.09911197
#&gt; 59_8_12 0.1191586 0.18173476 0.09911197
#&gt; 65_3_22 0.1007074 0.11333153 0.10857172
#&gt; 65_5_1  0.1007074 0.09578263 0.10857172
#&gt; 65_1_10 0.1007074 0.09578263 0.10857172</div><div class='input'>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'>transformCounts</span><span class='op'>(</span><span class='va'>x</span>, method<span class='op'>=</span><span class='st'>"relabundance"</span>, abund_values<span class='op'>=</span><span class='st'>"test"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>assay</span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"relabundance"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                  B          C          D
#&gt; 59_8_22 0.04743426 0.02949375 0.02024284
#&gt; 59_5_13 0.01430197 0.01592845 0.01431385
#&gt; 59_8_12 0.01692231 0.02554234 0.01431385
#&gt; 65_3_22 0.01430197 0.01592845 0.01568003
#&gt; 65_5_1  0.01430197 0.01346200 0.01568003
#&gt; 65_1_10 0.01430197 0.01346200 0.01568003</div><div class='input'>
<span class='co'># pa returns presence absence table. With 'threshold', it is possible to set the</span>
<span class='co'># threshold to desired level. By default, it is 0.</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'>transformCounts</span><span class='op'>(</span><span class='va'>x</span>, method<span class='op'>=</span><span class='st'>"pa"</span>, threshold<span class='op'>=</span><span class='fl'>35</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>assay</span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"pa"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;         B C D
#&gt; 59_8_22 1 0 0
#&gt; 59_5_13 0 0 0
#&gt; 59_8_12 0 0 0
#&gt; 65_3_22 0 0 0
#&gt; 65_5_1  0 0 0
#&gt; 65_1_10 0 0 0</div><div class='input'>
<span class='co'># Z-transform can be done for features</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'>ZTransform</span><span class='op'>(</span><span class='va'>x</span>, pseudocount<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>assay</span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"ZTransform"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                  B           C          D
#&gt; 59_8_22  0.9557828  0.08323189 -1.0390147
#&gt; 59_5_13 -0.5773503  1.15470054 -0.5773503
#&gt; 59_8_12 -0.1110960  1.05090886 -0.9398129
#&gt; 65_3_22 -1.0750696  0.90245812  0.1726115
#&gt; 65_5_1  -0.5773503 -0.57735027  1.1547005
#&gt; 65_1_10 -0.5773503 -0.57735027  1.1547005</div><div class='input'>
<span class='co'># Relative abundances can be also calculate with the dedicated</span>
<span class='co'># relAbundanceCounts function.</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'>relAbundanceCounts</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>assay</span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"relabundance"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                   B           C          D
#&gt; 59_8_22 0.246305419 0.074509804 0.02283105
#&gt; 59_5_13 0.000000000 0.007843137 0.00000000
#&gt; 59_8_12 0.009852217 0.050980392 0.00000000
#&gt; 65_3_22 0.000000000 0.007843137 0.00456621
#&gt; 65_5_1  0.000000000 0.000000000 0.00456621
#&gt; 65_1_10 0.000000000 0.000000000 0.00456621</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Felix G.M. Ernst, Sudarshan Shetty, Tuomas Borman, Leo Lahti.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


