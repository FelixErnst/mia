<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Merge a subset of the rows or columns of a SummarizedExperiment — merge-methods • mia</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Merge a subset of the rows or columns of a SummarizedExperiment — merge-methods" />
<meta property="og:description" content="mergeRows/mergeCols merge data on rows or columns of a
SummarizedExperiment as defined by a factor alongside the
chosen dimension. Metadata from the rowData or colData are
retained as defined by archetype." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.21</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mia.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/microbiome/mia/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Merge a subset of the rows or columns of a <code>SummarizedExperiment</code></h1>
    <small class="dont-index">Source: <a href='https://github.com/microbiome/mia/blob/master/R/merge.R'><code>R/merge.R</code></a></small>
    <div class="hidden name"><code>merge-methods.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>mergeRows</code>/<code>mergeCols</code> merge data on rows or columns of a
<code>SummarizedExperiment</code> as defined by a <code>factor</code> alongside the
chosen dimension. Metadata from the <code>rowData</code> or <code>colData</code> are
retained as defined by <code>archetype</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>mergeRows</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>f</span>, archetype <span class='op'>=</span> <span class='fl'>1L</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>mergeCols</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>f</span>, archetype <span class='op'>=</span> <span class='fl'>1L</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for SummarizedExperiment</span>
<span class='fu'>mergeRows</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>f</span>, archetype <span class='op'>=</span> <span class='fl'>1L</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for SummarizedExperiment</span>
<span class='fu'>mergeCols</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>f</span>, archetype <span class='op'>=</span> <span class='fl'>1L</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for TreeSummarizedExperiment</span>
<span class='fu'>mergeRows</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>f</span>, archetype <span class='op'>=</span> <span class='fl'>1L</span>, mergeTree <span class='op'>=</span> <span class='cn'>FALSE</span>, mergeRefSeq <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for TreeSummarizedExperiment</span>
<span class='fu'>mergeCols</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>f</span>, archetype <span class='op'>=</span> <span class='fl'>1L</span>, mergeTree <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a <code><a href='https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html'>SummarizedExperiment</a></code> or
a <code><a href='https://rdrr.io/pkg/TreeSummarizedExperiment/man/TreeSummarizedExperiment-class.html'>TreeSummarizedExperiment</a></code></p></td>
    </tr>
    <tr>
      <th>f</th>
      <td><p>A factor for merging. Must be the same length as
<code>nrow(x)/ncol(x)</code>. Rows/Cols corresponding to the same level will be
merged. If <code>length(levels(f)) == nrow(x)/ncol(x)</code>, <code>x</code> will be
returned unchanged.</p></td>
    </tr>
    <tr>
      <th>archetype</th>
      <td><p>Of each level of <code>f</code>, which element should be regarded
as the archetype and metadata in the columns or rows kept, while merging?
This can be single interger value or an integer vector of the same length
as <code><a href='https://rdrr.io/r/base/levels.html'>levels(f)</a></code>. (Default: <code>archetype = 1L</code>, which means the first
element encountered per factor level will be kept)</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>optional arguments:</p><ul>
<li><p>passed onto <code><a href='https://rdrr.io/pkg/scuttle/man/sumCountsAcrossFeatures.html'>sumCountsAcrossFeatures</a></code>, except <code>subset_row</code>, <code>subset_col</code></p></li>
</ul></td>
    </tr>
    <tr>
      <th>mergeTree</th>
      <td><p><code>TRUE</code> or <code>FALSE</code>: should to
<code>rowTree()</code> also be merged? (Default: <code>mergeTree = FALSE</code>)</p></td>
    </tr>
    <tr>
      <th>mergeRefSeq</th>
      <td><p><code>TRUE</code> or <code>FALSE</code>: should a consensus sequence
calculate? If set to <code>FALSE</code>, the result from <code>archetype</code> is
returned; If set to <code>TRUE</code> the result from
<code><a href='https://rdrr.io/pkg/DECIPHER/man/ConsensusSequence.html'>DECIPHER::ConsensusSequence</a></code> is
returned. (Default: <code>mergeRefSeq = FALSE</code>)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an object with the same class <code>x</code> with the specified entries
merged into one entry in all relevant components.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>These functions are similar to
<code><a href='https://rdrr.io/pkg/scuttle/man/sumCountsAcrossFeatures.html'>sumCountsAcrossFeatures</a></code>.
However, additional support for <code>TreeSummarizedExperiment</code> was added and
science field agnostic names were used. In addition the <code>archetype</code>
argument lets the user select how to preserve row or columns data.</p>
<p>For merge data of assays the function from <code>scuttle</code> are used.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/scuttle/man/sumCountsAcrossFeatures.html'>sumCountsAcrossFeatures</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>esophagus</span><span class='op'>)</span>
<span class='va'>esophagus</span>
</div><div class='output co'>#&gt; class: TreeSummarizedExperiment 
#&gt; dim: 58 3 
#&gt; metadata(0):
#&gt; assays(1): counts
#&gt; rownames(58): 59_8_22 59_5_13 ... 65_9_9 59_2_6
#&gt; rowData names(0):
#&gt; colnames(3): B C D
#&gt; colData names(0):
#&gt; reducedDimNames(0):
#&gt; mainExpName: NULL
#&gt; altExpNames(0):
#&gt; rowLinks: a LinkDataFrame (58 rows)
#&gt; rowTree: 1 phylo tree(s) (58 leaves)
#&gt; colLinks: NULL
#&gt; colTree: NULL</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>rowTree</span><span class='op'>(</span><span class='va'>esophagus</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='input'><span class='co'># get a factor for merging</span>
<span class='va'>f</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/regmatches.html'>regmatches</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>esophagus</span><span class='op'>)</span>,
                       <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>regexpr</a></span><span class='op'>(</span><span class='st'>"^[0-9]*_[0-9]*"</span>,<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>esophagus</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>merged</span> <span class='op'>&lt;-</span> <span class='fu'>mergeRows</span><span class='op'>(</span><span class='va'>esophagus</span>,<span class='va'>f</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>rowTree</span><span class='op'>(</span><span class='va'>merged</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='merge-methods-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>#</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>GlobalPatterns</span><span class='op'>)</span>
<span class='va'>GlobalPatterns</span>
</div><div class='output co'>#&gt; class: TreeSummarizedExperiment 
#&gt; dim: 19216 26 
#&gt; metadata(0):
#&gt; assays(1): counts
#&gt; rownames(19216): 549322 522457 ... 200359 271582
#&gt; rowData names(7): Kingdom Phylum ... Genus Species
#&gt; colnames(26): CL3 CC1 ... Even2 Even3
#&gt; colData names(7): X.SampleID Primer ... SampleType Description
#&gt; reducedDimNames(0):
#&gt; mainExpName: NULL
#&gt; altExpNames(0):
#&gt; rowLinks: a LinkDataFrame (19216 rows)
#&gt; rowTree: 1 phylo tree(s) (19216 leaves)
#&gt; colLinks: NULL
#&gt; colTree: NULL</div><div class='input'><span class='va'>merged</span> <span class='op'>&lt;-</span> <span class='fu'>mergeCols</span><span class='op'>(</span><span class='va'>GlobalPatterns</span>,<span class='fu'>colData</span><span class='op'>(</span><span class='va'>GlobalPatterns</span><span class='op'>)</span><span class='op'>$</span><span class='va'>SampleType</span><span class='op'>)</span>
<span class='va'>merged</span>
</div><div class='output co'>#&gt; class: TreeSummarizedExperiment 
#&gt; dim: 19216 9 
#&gt; metadata(0):
#&gt; assays(1): counts
#&gt; rownames(19216): 549322 522457 ... 200359 271582
#&gt; rowData names(7): Kingdom Phylum ... Genus Species
#&gt; colnames(9): M31Fcsw LMEpi24M ... CL3 M31Tong
#&gt; colData names(7): X.SampleID Primer ... SampleType Description
#&gt; reducedDimNames(0):
#&gt; mainExpName: NULL
#&gt; altExpNames(0):
#&gt; rowLinks: a LinkDataFrame (19216 rows)
#&gt; rowTree: 1 phylo tree(s) (19216 leaves)
#&gt; colLinks: NULL
#&gt; colTree: NULL</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Felix G.M. Ernst, Sudarshan Shetty, Tuomas Borman, Leo Lahti.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


